# pwsh_CertificateExpirationChecker
Powershell 7 script to check a list of urls for Certificate Expiration Dates

Example of how to call it: 
```
.\CheckForExpiredSSLCertificates.ps1 -Path "C:\Temp\check-urls.csv" -To "IT@example.com" -From "powershell@example.com" -WarningCertAgeDays 20 -CriticalCertAgeDays 10 -Subject "SSL Expiration Notice" -SMTPServer "smtp.example.com"
```

<html>

Below is the list of URL's we are protecting with an SSL cert and the expiration date.<br><br><table border="1";> <colgroup><col/><col/><col/><col/><col/><col/><col/><col/><col/><col/></colgroup> <tr><th>URL</th><th>Check result</th><th>Expires in days</th><th>Expires on</th><th>Server</th><th>Business Application</th><th>Owner</th><th>Issuer</th><th>Wildcard</th><th>Details</th></tr> <tr><td>https://internalapp.example.com</td><td style='color: red'>CRITICAL</td><td>-37</td><td>3/1/2022</td><td>App Server 01</td><td>Internal App 1</td><td>Web Team</td><td>Internal CA</td><td></td><td>Expiration date is hard coded into the spreadsheet make sure to update the spreadsheet when the certificate is updated.</td></tr> <tr><td>https://brokenurl.example.com</td><td style='color: red'>ERROR</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>Exception while checking URL https://brokenurl.example.com: Exception calling &quot;.ctor&quot; with &quot;2&quot; argument(s): &quot;No such host is known.&quot; </td></tr> <tr><td>https://anotherinternalapp.example.com</td><td style='color: orange'>WARNING</td><td>42</td><td>5/20/2022</td><td>App Server 01</td><td>Another Internal App</td><td>Web Team</td><td>Internal CA</td><td></td><td>Expiration date is hard coded into the spreadsheet make sure to update the spreadsheet when the certificate is updated.</td></tr> <tr><td>https://en.wikipedia.org/</td><td style='color: green'>OKAY</td><td>63</td><td>6/10/2022 2:44:58 AM</td><td>Wikipedia web server</td><td>Wikipedia</td><td>Web Team</td><td>R3</td><td>Yes</td><td></td></tr> <tr><td>https://vpn.example.com</td><td style='color: green'>OKAY</td><td>327</td><td>3/1/2023</td><td>Firewall</td><td>VPN</td><td>Security Team</td><td>DigiCert</td><td></td><td>Expiration date is hard coded into the spreadsheet make sure to update the spreadsheet when the certificate is updated.</td></tr> <tr><td>https://example.com</td><td style='color: green'>OKAY</td><td>341</td><td>3/14/2023 6:59:59 PM</td><td>Web Server 01</td><td>Web Site</td><td>Web Team</td><td>DigiCert</td><td></td><td></td></tr> </table><br>Edit this file to update the list that is checked:<br> "C:\Temp\check-urls.csv"
</html>
